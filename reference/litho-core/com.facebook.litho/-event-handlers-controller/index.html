<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>EventHandlersController</title>
<link href="../../../images/logo-icon.svg" rel="icon" type="image/svg"><script>var pathToRoot = "../../../";</script>    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/jetbrains-mono.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/clipboard.js" async></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async></script>
<script type="text/javascript" src="../../../scripts/main.js" defer></script>
<script type="text/javascript" src="../../../scripts/prism.js" async></script>
<script type="text/javascript" src="../../../scripts/symbol-parameters-wrapper_deferred.js" defer></script></head>
<body>
<div class="navigation-wrapper" id="navigation-wrapper">
    <div id="leftToggler"><span class="icon-toggler"></span></div>
    <div class="library-name">
<a href="../../../index.html">
<span>Litho</span>            </a>    </div>
    <div>
    </div>
    <div class="pull-right d-flex">
        <button id="theme-toggle-button"><span id="theme-toggle"></span></button>
        <div id="searchBar"></div>
    </div>
</div>
<div id="container">
    <div id="leftColumn">
        <div id="sideMenu"></div>
    </div>
    <div id="main">
<div class="main-content" id="content" pageids="litho-core::com.facebook.litho/EventHandlersController///PointingToDeclaration//947585829">
  <div class="breadcrumbs"><a href="../../index.html">litho-core</a><span class="delimiter">/</span><a href="../index.html">com.facebook.litho</a><span class="delimiter">/</span><span class="current">EventHandlersController</span></div>
  <div class="cover ">
    <h1 class="cover"><span>Event</span><wbr><span>Handlers</span><wbr><span><span>Controller</span></span></h1>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><span class="token keyword">class </span><a href="index.html">EventHandlersController</a></div><p class="paragraph">Controller which makes sure EventHandler instances are bound to the latest instance of the Component/Section that created them.</p><p class="paragraph">To see the problem this is trying to solve, consider a Section with a button Component with a click handler as one of its rows. When the section updates (e.g. performs a state update), nothing about how the button renders changes, so we don't want to re-resolve it. However, if we don't re-resolve it, the click handler points to an old instance of the Section (the Section before the state update).</p><p class="paragraph">To get the best of both worlds, we don't re-render the button and use this class to update the EventDispatchInfo on all EventHandlers created in this tree to their latest Component/Section owners.</p><p class="paragraph">In order to do this, all EventHandlers created by a given component/section (identified by their global key) is given a reference to the same EventDispatchInfo instance. Then on each tree resolution, we update this EventDispatchInfo with the latest instance of the context and component/section.</p><h2 class=""> Details of the full flow in the context of Components</h2><ul><li></li><ul><li><p class="paragraph">During a resolve or layout (or resolve+layout), we record all Spec-generated EventHandlers in a list local to this computation.</p></li></ul><li></li><ul><li><p class="paragraph">When we create EventHandlers, we create them with the latest ComponentContext and EventDispatcher (the two together are what we call DispatchInfo) but don't update any existing committed EventHandlers.</p></li></ul><li></li><ul><li><p class="paragraph">The ResolveResult has just the EventHandlers from resolve, but the LayoutState (result of layout computation) has both the EventHandlers created in resolve and the EventHandlers created in layout</p></li></ul><li></li><ul><li><p class="paragraph">If we commit this LayoutState, we 'canonicalize' the DispatchInfos on the EventHandlers we created. This means we update the collected EventHandler's DispatchInfos to be the 'canonical' DispatchInfos we already have for that global key (if we don't have one, that DispatchInfo becomes the canonical DispatchInfo for that key)</p></li></ul><li></li><ul><li><p class="paragraph">Finally, we update the canonical DispatchInfos for each global key to the latest ComponentContext/EventDispatcher from the newly committed LayoutState.</p></li></ul></ul><p class="paragraph">By having all committed EventHandlers for a global key reference the same DispatchInfo, we can update them all at the same time when a new LayoutState is committed.</p></div></div>
  </div>
  <div class="tabbedcontent">
    <div class="tabs-section" tabs-section="tabs-section"><button class="section-tab" data-active="" data-togglable="Types">Types</button><button class="section-tab" data-togglable="Constructors">Constructors</button><button class="section-tab" data-togglable="Functions">Functions</button><button class="section-tab" data-togglable="Properties">Properties</button></div>
    <div class="tabs-section-body">
      <h2 class="tabbedcontent">Constructors</h2>
      <div class="table" data-togglable="Constructors"><a data-name="697952890%2FConstructors%2F947585829" anchor-label="EventHandlersController" id="697952890%2FConstructors%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue TabbedContent">
            <div class=""><span class="inline-flex">
                <div><a href="-event-handlers-controller.html"><span>Event</span><wbr><span>Handlers</span><wbr><span><span>Controller</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="697952890%2FConstructors%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><span class="token keyword"></span><span class="token keyword">fun </span><a href="-event-handlers-controller.html"><span class="token function">EventHandlersController</span></a><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <h2 class="">Types</h2>
      <div class="table" data-togglable="Types"><a data-name="-410594847%2FClasslikes%2F947585829" anchor-label="DispatchInfoWrapper" id="-410594847%2FClasslikes%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue ">
            <div class=""><span class="inline-flex">
                <div><a href="-dispatch-info-wrapper/index.html"><span>Dispatch</span><wbr><span>Info</span><wbr><span><span>Wrapper</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-410594847%2FClasslikes%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><span class="token keyword">class </span><a href="-dispatch-info-wrapper/index.html">DispatchInfoWrapper</a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword">val </span>dispatchInfo<span class="token operator">: </span><a href="../-event-dispatch-info/index.html">EventDispatchInfo</a></span></span><span class="token punctuation">)</span></div></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <h2 class="">Functions</h2>
      <div class="table" data-togglable="Functions"><a data-name="-1471542492%2FFunctions%2F947585829" anchor-label="canonicalizeEventDispatchInfos" id="-1471542492%2FFunctions%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue ">
            <div class=""><span class="inline-flex">
                <div><a href="canonicalize-event-dispatch-infos.html"><span>canonicalize</span><wbr><span>Event</span><wbr><span>Dispatch</span><wbr><span><span>Infos</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1471542492%2FFunctions%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-synchronized/index.html"><span class="token annotation builtin">Synchronized</span></a></div></div><span class="token keyword"></span><span class="token keyword">fun </span><a href="canonicalize-event-dispatch-infos.html"><span class="token function">canonicalizeEventDispatchInfos</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">eventHandlers<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html">List</a><span class="token operator">&lt;</span><span class="token keyword"></span><a href="https://developer.android.com/reference/kotlin/android/util/Pair.html">Pair</a><span class="token operator">&lt;</span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html">String</a><span class="token punctuation">, </span><span class="token keyword"></span><a href="../-event-handler/index.html">EventHandler</a><span class="token operator">&lt;</span><span class="token operator">*</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">)</span></div><div class="brief "><p class="paragraph">For a list of Pair(GlobalKey, EventHandler), updates the EventDispatchInfo on each EventHandler to be the canonical EventDispatchInfos for the corresponding global key. This means that from now on, when EventDispatchInfos are re-bound in .updateEventDispatchInfoForGlobalKey, these EventHandlers will also be updated.</p></div></div></div>
              </div>
            </div>
          </div>
        </div>
<a data-name="882676101%2FFunctions%2F947585829" anchor-label="clearUnusedEventDispatchInfos" id="882676101%2FFunctions%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue ">
            <div class=""><span class="inline-flex">
                <div><a href="clear-unused-event-dispatch-infos.html"><span>clear</span><wbr><span>Unused</span><wbr><span>Event</span><wbr><span>Dispatch</span><wbr><span><span>Infos</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="882676101%2FFunctions%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-synchronized/index.html"><span class="token annotation builtin">Synchronized</span></a></div></div><span class="token keyword"></span><span class="token keyword">fun </span><a href="clear-unused-event-dispatch-infos.html"><span class="token function">clearUnusedEventDispatchInfos</span></a><span class="token punctuation">(</span><span class="token punctuation">)</span></div><div class="brief "><p class="paragraph">If a global key doesn't appear in the current tree, remove its EventDispatchInfo from our book keeping.</p></div></div></div>
              </div>
            </div>
          </div>
        </div>
<a data-name="386699669%2FFunctions%2F947585829" anchor-label="updateEventDispatchInfoForGlobalKey" id="386699669%2FFunctions%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue ">
            <div class=""><span class="inline-flex">
                <div><a href="update-event-dispatch-info-for-global-key.html"><span>update</span><wbr><span>Event</span><wbr><span>Dispatch</span><wbr><span>Info</span><wbr><span>For</span><wbr><span>Global</span><wbr><span><span>Key</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="386699669%2FFunctions%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-synchronized/index.html"><span class="token annotation builtin">Synchronized</span></a></div></div><span class="token keyword"></span><span class="token keyword">fun </span><a href="update-event-dispatch-info-for-global-key.html"><span class="token function">updateEventDispatchInfoForGlobalKey</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">c<span class="token operator">: </span><a href="../-component-context/index.html">ComponentContext</a><span class="token punctuation">, </span></span><span class="parameter ">dispatcher<span class="token operator">: </span><a href="../-has-event-dispatcher/index.html">HasEventDispatcher</a><span class="token punctuation">, </span></span><span class="parameter ">globalKey<span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html">String</a><span class="token operator">?</span></span></span><span class="token punctuation">)</span></div><div class="brief "><p class="paragraph">Updates the EventDispatchInfo for this global key with the latest context and component/section. All EventHandlers created by this global key have the same EventDispatchInfo instance.</p></div></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <h2 class="">Properties</h2>
      <div class="table" data-togglable="Properties"><a data-name="352834766%2FProperties%2F947585829" anchor-label="dispatchInfos" id="352834766%2FProperties%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a>
        <div class="table-row" data-filterable-current=":litho-core:dokkaHtmlPartial/release" data-filterable-set=":litho-core:dokkaHtmlPartial/release">
          <div class="main-subrow keyValue ">
            <div class=""><span class="inline-flex">
                <div><a href="dispatch-infos.html"><span>dispatch</span><wbr><span><span>Infos</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="352834766%2FProperties%2F947585829"></span>
                  <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                </span></span></div>
            <div>
              <div class="title">
                <div class="platform-hinted " data-platform-hinted="data-platform-hinted" data-togglable="Properties"><div class="content sourceset-dependent-content" data-active="" data-togglable=":litho-core:dokkaHtmlPartial/release"><a data-name="352834766%2FProperties%2F947585829" anchor-label="dispatchInfos" id="352834766%2FProperties%2F947585829" data-filterable-set=":litho-core:dokkaHtmlPartial/release"></a><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@get:</span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.jvm/-synchronized/index.html"><span class="token annotation builtin">Synchronized</span></a></div></div><span class="token keyword"></span><span class="token keyword">val </span><a href="dispatch-infos.html">dispatchInfos</a><span class="token operator">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html">Map</a><span class="token operator">&lt;</span><span class="token keyword"></span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html">String</a><span class="token punctuation">, </span><span class="token keyword"></span><a href="-dispatch-info-wrapper/index.html">EventHandlersController.DispatchInfoWrapper</a><span class="token operator">&gt;</span></div></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>Â© 2023 Copyright</span><span class="pull-right"><span>Generated by </span><a href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
    </div>
</div>

</body></html>

