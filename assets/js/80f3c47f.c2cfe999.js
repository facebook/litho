"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4828],{15680:(e,t,n)=>{n.r(t),n.d(t,{MDXContext:()=>c,MDXProvider:()=>m,mdx:()=>b,useMDXComponents:()=>p,withMDXComponents:()=>d});var i=n(96540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=i.createContext({}),d=function(e){return function(t){var n=p(t.components);return i.createElement(e,o({},t,{components:n}))}},p=function(e){var t=i.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=p(e.components);return i.createElement(c.Provider,{value:t},e.children)},u="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},v=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=a,u=d["".concat(l,".").concat(m)]||d[m]||y[m]||o;return n?i.createElement(u,r(r({ref:t},c),{},{components:n})):i.createElement(u,r({ref:t},c))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=v;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r[u]="string"==typeof e?e:a,l[1]=r;for(var c=2;c<o;c++)l[c]=n[c];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}v.displayName="MDXCreateElement"},23376:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>y,frontMatter:()=>r,metadata:()=>c,toc:()=>p});var i=n(58168),a=n(98587),o=(n(96540),n(15680)),l=["components"],r={id:"accessibility-overview",title:"Making the UI Accessible"},s=void 0,c={unversionedId:"codegen/accessibility-overview",id:"codegen/accessibility-overview",title:"Making the UI Accessible",description:"This section contains information about the old Java Spec API.",source:"@site/../docs/codegen/accessibility-overview.md",sourceDirName:"codegen",slug:"/codegen/accessibility-overview",permalink:"/docs/codegen/accessibility-overview",draft:!1,editUrl:"https://github.com/facebook/litho/edit/master/website/../docs/codegen/accessibility-overview.md",tags:[],version:"current",frontMatter:{id:"accessibility-overview",title:"Making the UI Accessible"},sidebar:"mainSidebar",previous:{title:"More Ways to Define Transitions",permalink:"/docs/codegen/transition-definitions"},next:{title:"Sections Basics",permalink:"/docs/sections/start"}},d={},p=[{value:"Why Accessibility is important",id:"why-accessibility-is-important",level:2},{value:"Content Description",id:"content-description",level:2},{value:"Custom accessibility",id:"custom-accessibility",level:2},{value:"Extra accessibility nodes",id:"extra-accessibility-nodes",level:2},{value:"Accessibility handling",id:"accessibility-handling",level:2},{value:"Accessibility Heading",id:"accessibility-heading",level:2}],m={toc:p},u="wrapper";function y(e){var t=e.components,n=(0,a.A)(e,l);return(0,o.mdx)(u,(0,i.A)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.mdx)("admonition",{type:"caution"},(0,o.mdx)("p",{parentName:"admonition"},"This section contains information about the old Java Spec API.\nFor new development, the Kotlin API is recommended (see the ",(0,o.mdx)("a",{parentName:"p",href:"/docs/accessibility/"},"Accessibility")," page in the 'Accessibility' section).")),(0,o.mdx)("h2",{id:"why-accessibility-is-important"},"Why Accessibility is important"),(0,o.mdx)("p",null,"The fundamental purpose of an interface is to provide people with access to information. Accessibility is the foundation of an interface. All people experience limitations in their abilities, whether it's temporary, situational or permanent. The aim of accessibility is to remove any obstacles that reduce the experience of using, understanding, and navigating the interface."),(0,o.mdx)("p",null,"This page provides details of the Litho components, methods, nodes, events, and headings available to ensure the interface provides the 'full experience' promoted by Meta."),(0,o.mdx)("admonition",{type:"info"},(0,o.mdx)("p",{parentName:"admonition"},"For information on how Meta is committed to creating a full UI experience for ",(0,o.mdx)("strong",{parentName:"p"},"all")," people, see the ",(0,o.mdx)("a",{parentName:"p",href:"https://en-gb.facebook.com/accessibility/"},"Meta Accessibility")," site.")),(0,o.mdx)("h2",{id:"content-description"},"Content Description"),(0,o.mdx)("p",null,"By default, all components support content description. This means all layout builders have a prop of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"CharSequence")," named ",(0,o.mdx)("inlineCode",{parentName:"p"},"contentDescription")," ."),(0,o.mdx)("p",null,"Setting a content description on any component is achieved with the following:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},'Image.create(c)\n    .imageRes(R.drawable.some_image)\n    .contentDescription("This is an image")\n    .build();\n')),(0,o.mdx)("p",null,"The content description set here has the same semantics as when set on an Android view."),(0,o.mdx)("h2",{id:"custom-accessibility"},"Custom accessibility"),(0,o.mdx)("p",null,"Mount Specs can implement their own accessibility support by implementing an ",(0,o.mdx)("inlineCode",{parentName:"p"},"@OnPopulateAccessibilityNode")," method. This method accepts an ",(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityNodeInfoCompat")," argument as well as any props that are specified on the spec method."),(0,o.mdx)("p",null,"For example, accessibility for ",(0,o.mdx)("inlineCode",{parentName:"p"},"Text")," is specified using the following method:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},"@OnPopulateAccessibilityNode\nstatic void onPopulateAccessibilityNode(\n    AccessibilityNodeInfoCompat accessibilityNode,\n    @Prop CharSequence text) {\n  accessibilityNode.setText(text);\n}\n")),(0,o.mdx)("p",null,"This is only applicable for components that mount drawables since, if the component mounts a view, the support is built in."),(0,o.mdx)("h2",{id:"extra-accessibility-nodes"},"Extra accessibility nodes"),(0,o.mdx)("p",null,"On more complex mount specs that need to expose extra nodes to the accessibility framework, you'll have to implement three extra methods with the following annotations:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"GetExtraAccessibilityNodesCount")," - returns number of extra accessibility nodes exposed by the component."),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("strong",{parentName:"li"},"OnPopulateExtraAccessibilityNode")," - populates the extra accessibility node with the given bounds.")),(0,o.mdx)("h2",{id:"accessibility-handling"},"Accessibility handling"),(0,o.mdx)("p",null,"All components support a set of events corresponding to ",(0,o.mdx)("a",{parentName:"p",href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html"},"AccessibilityDelegateCompat"),"'s methods.\nThese events have attributes for each parameter of the corresponding ",(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityDelegateCompat")," method ",(0,o.mdx)("em",{parentName:"p"},"and")," an additional parameter of type ",(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityDelegateCompat")," called ",(0,o.mdx)("inlineCode",{parentName:"p"},"superDelegate"),", which enable a ",(0,o.mdx)("inlineCode",{parentName:"p"},"View"),"'s default implementation of accessibility methods to be called explicitly where necessary."),(0,o.mdx)("p",null,"The following table provides an overview of the supported events:"),(0,o.mdx)("table",null,(0,o.mdx)("thead",{parentName:"table"},(0,o.mdx)("tr",{parentName:"thead"},(0,o.mdx)("th",{parentName:"tr",align:null},"Event"),(0,o.mdx)("th",{parentName:"tr",align:null},"AccessibilityDelegate method"))),(0,o.mdx)("tbody",{parentName:"table"},(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"DispatchPopulateAccessibilityEventEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#dispatchPopulateAccessibilityEvent(android.view.View, android.view.accessibility.AccessibilityEvent)"},"dispatchPopulateAccessibilityEvent"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"OnInitializeAccessibilityEventEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#onInitializeAccessibilityEvent(android.view.View, android.view.accessibility.AccessibilityEvent)"},"onInitializeAccessibilityEvent"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"OnInitializeAccessibilityNodeInfoEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#onInitializeAccessibilityNodeInfo(android.view.View, android.support.v4.view.accessibility.AccessibilityNodeInfoCompat)"},"onInitializeAccessibilityNodeInfo"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"OnPopulateAccessibilityEventEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#onPopulateAccessibilityEvent(android.view.View, android.view.accessibility.AccessibilityEvent)"},"onPopulateAccessibilityEvent"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"OnRequestSendAccessibilityEventEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#onRequestSendAccessibilityEvent(android.view.ViewGroup, android.view.View, android.view.accessibility.AccessibilityEvent)"},"onRequestSendAccessibilityEvent"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"PerformAccessibilityActionEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#performAccessibilityAction(android.view.View, int, android.os.Bundle)"},"performAccessibilityAction"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"SendAccessibilityEventEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#sendAccessibilityEvent(android.view.View, int)"},"sendAccessibilityEvent"))),(0,o.mdx)("tr",{parentName:"tbody"},(0,o.mdx)("td",{parentName:"tr",align:null},"SendAccessibilityUncheckedEvent"),(0,o.mdx)("td",{parentName:"tr",align:null},(0,o.mdx)("a",{href:"https://developer.android.com/reference/android/support/v4/view/AccessibilityDelegateCompat.html#sendAccessibilityEventUnchecked(android.view.View, android.view.accessibility.AccessibilityEvent)"},"sendAccessibilityEventUnchecked"))))),(0,o.mdx)("p",null,"Setting a handler for any of these events will result in an ",(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityDelegate")," being set on the mounted ",(0,o.mdx)("inlineCode",{parentName:"p"},"View"),", which will call the event handler when the corresponding method is called."),(0,o.mdx)("p",null,"Whenever a method with no supplied event handler is called, the delegate will defer to the Android ",(0,o.mdx)("inlineCode",{parentName:"p"},"View"),"'s default implementation (equivalent to calling ",(0,o.mdx)("inlineCode",{parentName:"p"},"super")," or ",(0,o.mdx)("inlineCode",{parentName:"p"},"superDelegate"),"'s implementation)."),(0,o.mdx)("p",null,"The following three steps provide an example of overriding ",(0,o.mdx)("inlineCode",{parentName:"p"},"onInitializeAccessibilityNodeInfo")," for a component:"),(0,o.mdx)("ol",null,(0,o.mdx)("li",{parentName:"ol"},"Implement an event handler:")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},"@OnEvent(OnInitializeAccessibilityNodeInfoEvent.class)\nstatic void onInitializeAccessibilityNodeInfoEvent(\n    ComponentContext c,\n    @FromEvent AccessibilityDelegateCompat superDelegate,\n    @FromEvent View host,\n    @FromEvent AccessibilityNodeInfoCompat info) {\n  // Equivalent to calling super on a regular AccessibilityDelegate, not required\n  superDelegate.onInitializeAccessibilityNodeInfo(view, info);\n  // My implementation\n}\n")),(0,o.mdx)("ol",{start:2},(0,o.mdx)("li",{parentName:"ol"},"Set the event handler on a component:")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},"Text.create(c)\n    .text(title)\n    .onInitializeAccessiblityNodeInfoHandler(MyComponent.onInitializeAccessibilityNodeInfoEvent(c));\n")),(0,o.mdx)("p",null,"One of the best features of ",(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityDelegate"),"s in general is their reusability even across different types of ",(0,o.mdx)("inlineCode",{parentName:"p"},"View"),'s. This can also be achieved within Litho by creating a wrapper spec that takes in a component and adds the desired event handlers. For example, let\'s say we want to have a Component that appends "please" to every ',(0,o.mdx)("inlineCode",{parentName:"p"},"AccessibilityEvent")," that it announces."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},'@LayoutSpec\nclass PoliteComponentWrapper {\n\n  @OnCreateLayout\n  static Component onCreateLayout(\n      ComponentContext c,\n      @Prop Component content) {\n\n    return Wrapper.create(c)\n        .delegate(content)\n        .onPopulateAccessibilityEventHandler(\n            PoliteComponentWrapper.onPopulateAccessibilityEvent(c))\n        .build();\n  }\n\n  @OnEvent(OnPopulateAccessibilityEvent.class)\n  static void onPopulateAccessibilityEvent(\n      ComponentContext c,\n      @FromEvent AccessibilityDelegateCompat superDelegate,\n      @FromEvent View view\n      @FromEvent AccessibilityEvent event) {\n    superDelegate.onPopulateAccessibilityEvent(view, event);\n    event.getText().add("please");\n  }\n}\n')),(0,o.mdx)("ol",{start:3},(0,o.mdx)("li",{parentName:"ol"},"Replace any uses of a component with ",(0,o.mdx)("inlineCode",{parentName:"li"},"PoliteComponentWrapper"),":")),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},"@OnCreateLayout\nstatic Component onCreateLayout(\n    ComponentContext c,\n    @Prop CharSequence text) {\n\n  return PoliteComponentWrapper.create(c)\n      .content(\n           Text.create(c)\n               .text(text))\n      .build();\n}\n")),(0,o.mdx)("h2",{id:"accessibility-heading"},"Accessibility Heading"),(0,o.mdx)("p",null,"Heading is an accessibility property that helps users to choose to 'Navigate by Headings' and ignore scrolling through each and every subitem under a heading. 'Navigate based on Heading' can be selected from \"Local Context Menu\" when talkback is on. Talkback gesture for \"Local Context Menu\" is ",(0,o.mdx)("strong",{parentName:"p"},"Swipe up then right"),"."),(0,o.mdx)("p",null,"Making any component an Accessibility Header is as simple as the following:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre",className:"language-java"},'Row.create(c)\n    .contentDescription("This is an accessibility heading")\n    .accessibilityHeading(true)\n    .build();\n')))}y.isMDXComponent=!0}}]);