"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9389,5575,7956,813,3194,5099,7480,337,2718,4623],{15680:(e,t,n)=>{n.r(t),n.d(t,{MDXContext:()=>c,MDXProvider:()=>d,mdx:()=>v,useMDXComponents:()=>p,withMDXComponents:()=>u});var r=n(96540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=r.createContext({}),u=function(e){return function(t){var n=p(t.components);return r.createElement(e,a({},t,{components:n}))}},p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},m="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},y=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=o,m=u["".concat(i,".").concat(d)]||u[d]||f[d]||a;return n?r.createElement(m,l(l({ref:t},c),{},{components:n})):r.createElement(m,l({ref:t},c))}));function v(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=y;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}y.displayName="MDXCreateElement"},19365:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(96540),o=n(20053);const a={tabItem:"tabItem_Ymn6"};function i(e){var t=e.children,n=e.hidden,i=e.className;return r.createElement("div",{role:"tabpanel",className:(0,o.default)(a.tabItem,i),hidden:n},t)}},11470:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var r=n(58168),o=n(96540),a=n(20053),i=n(23104),l=n(56347),s=n(57485),c=n(31682),u=n(89466);function p(e){return function(e){var t,n;return null!=(t=null==(n=o.Children.map(e,(function(e){if(!e||(0,o.isValidElement)(e)&&(t=e.props)&&"object"==typeof t&&"value"in t)return e;var t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}function d(e){var t=e.values,n=e.children;return(0,o.useMemo)((function(){var e=null!=t?t:p(n);return function(e){var t=(0,c.X)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function m(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function f(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId,a=(0,l.W6)(),i=function(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:n,groupId:r});return[(0,s.aZ)(i),(0,o.useCallback)((function(e){if(i){var t=new URLSearchParams(a.location.search);t.set(i,e),a.replace(Object.assign({},a.location,{search:t.toString()}))}}),[i,a])]}function y(e){var t,n,r,a,i=e.defaultValue,l=e.queryString,s=void 0!==l&&l,c=e.groupId,p=d(e),y=(0,o.useState)((function(){return function(e){var t,n=e.defaultValue,r=e.tabValues;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+r.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var o=null!=(t=r.find((function(e){return e.default})))?t:r[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:i,tabValues:p})})),v=y[0],g=y[1],h=f({queryString:s,groupId:c}),b=h[0],k=h[1],x=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:c}.groupId),n=(0,u.Dv)(t),r=n[0],a=n[1],[r,(0,o.useCallback)((function(e){t&&a.set(e)}),[t,a])]),w=x[0],N=x[1],O=function(){var e=null!=b?b:w;return m({value:e,tabValues:p})?e:null}();return(0,o.useLayoutEffect)((function(){O&&g(O)}),[O]),{selectedValue:v,selectValue:(0,o.useCallback)((function(e){if(!m({value:e,tabValues:p}))throw new Error("Can't select invalid tab value="+e);g(e),k(e),N(e)}),[k,N,p]),tabValues:p}}var v=n(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function h(e){var t=e.className,n=e.block,l=e.selectedValue,s=e.selectValue,c=e.tabValues,u=[],p=(0,i.a_)().blockElementScrollPositionUntilNextRender,d=function(e){var t=e.currentTarget,n=u.indexOf(t),r=c[n].value;r!==l&&(p(t),s(r))},m=function(e){var t,n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":var r,o=u.indexOf(e.currentTarget)+1;n=null!=(r=u[o])?r:u[0];break;case"ArrowLeft":var a,i=u.indexOf(e.currentTarget)-1;n=null!=(a=u[i])?a:u[u.length-1]}null==(t=n)||t.focus()};return o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.default)("tabs",{"tabs--block":n},t)},c.map((function(e){var t=e.value,n=e.label,i=e.attributes;return o.createElement("li",(0,r.A)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:function(e){return u.push(e)},onKeyDown:m,onClick:d},i,{className:(0,a.default)("tabs__item",g.tabItem,null==i?void 0:i.className,{"tabs__item--active":l===t})}),null!=n?n:t)})))}function b(e){var t=e.lazy,n=e.children,r=e.selectedValue,a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){var i=a.find((function(e){return e.props.value===r}));return i?(0,o.cloneElement)(i,{className:"margin-top--md"}):null}return o.createElement("div",{className:"margin-top--md"},a.map((function(e,t){return(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==r})})))}function k(e){var t=y(e);return o.createElement("div",{className:(0,a.default)("tabs-container",g.tabList)},o.createElement(h,(0,r.A)({},e,t)),o.createElement(b,(0,r.A)({},e,t)))}function x(e){var t=(0,v.default)();return o.createElement(k,(0,r.A)({key:String(t)},e))}},74646:(e,t,n)=>{n.d(t,{A:()=>m});var r=n(58168),o=n(96540),a=n(68382),i=n(45603),l=n(76062),s="0.50.2",c="0.51.0-SNAPSHOT",u="0.10.5",p="0.142.0",d=n(6342);const m=function(e){var t=e.language,n=e.code.replace(/{{site.lithoVersion}}/g,s).replace(/{{site.soloaderVersion}}/g,u).replace(/{{site.lithoSnapshotVersion}}/g,c).replace(/{{site.flipperVersion}}/g,p).trim(),m=(0,d.p)().isDarkTheme?l.A:i.A;return o.createElement(a.Ay,(0,r.A)({},a.Gs,{code:n,language:t,theme:m}),(function(e){var t=e.className,n=e.style,r=e.tokens,a=e.getLineProps,i=e.getTokenProps;return o.createElement("pre",{className:t,style:n},r.map((function(e,t){return o.createElement("div",a({line:e,key:t}),e.map((function(e,t){return o.createElement("span",i({token:e,key:t}))})))})))}))}},83575:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>f,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var r=n(58168),o=n(98587),a=(n(96540),n(15680)),i=(n(11470),n(19365),n(74646),["components"]),l={id:"migrate-layout-spec",title:"Migrating Layout Spec",keywords:["litho","litho kotlin","kotlin litho","layout spec"],custom_edit_url:"https://www.internalfb.com/intern/diffusion/FBS/browsefile/master/fbandroid/libraries/components/docs/kotlin/migrating-layout-spec.mdx"},s=void 0,c={unversionedId:"kotlin/migrate-layout-spec",id:"kotlin/migrate-layout-spec",title:"Migrating Layout Spec",description:"Overview",source:"@site/../docs/kotlin/migrating-layout-spec.mdx",sourceDirName:"kotlin",slug:"/kotlin/migrate-layout-spec",permalink:"/docs/kotlin/migrate-layout-spec",draft:!1,editUrl:"https://www.internalfb.com/intern/diffusion/FBS/browsefile/master/fbandroid/libraries/components/docs/kotlin/migrating-layout-spec.mdx",tags:[],version:"current",frontMatter:{id:"migrate-layout-spec",title:"Migrating Layout Spec",keywords:["litho","litho kotlin","kotlin litho","layout spec"],custom_edit_url:"https://www.internalfb.com/intern/diffusion/FBS/browsefile/master/fbandroid/libraries/components/docs/kotlin/migrating-layout-spec.mdx"},sidebar:"mainSidebar",previous:{title:"Event Handling",permalink:"/docs/kotlin/event-handling"},next:{title:"Migrating MountSpecs",permalink:"/docs/kotlin/migrating-from-mountspecs-to-primitives"}},u={},p=[{value:"Overview",id:"overview",level:2},{value:"Benefits of Migration",id:"benefits-of-migration",level:2},{value:"Migration Process",id:"migration-process",level:2},{value:"Current Limitations",id:"current-limitations",level:2},{value:"Additional Resources",id:"additional-resources",level:2}],d={toc:p},m="wrapper";function f(e){var t=e.components,n=(0,o.A)(e,i);return(0,a.mdx)(m,(0,r.A)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.mdx)("h2",{id:"overview"},"Overview"),(0,a.mdx)("p",null,"This guide provides detailed instructions for migrating from the Litho LayoutSpec API to the KComponent API. The transition is crucial as the Litho Spec API is now in maintenance mode, with limited support and no new features being added. Migrating to the KComponent API offers performance improvements, enhanced stability, and compile-time reliability checks."),(0,a.mdx)("h2",{id:"benefits-of-migration"},"Benefits of Migration"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},"Stability: Converts many runtime crashes into compile-time errors."),(0,a.mdx)("li",{parentName:"ul"},"Performance: Improves build time as there is no generated code required."),(0,a.mdx)("li",{parentName:"ul"},"Support: The Spec API will only receive bug fixes, with all new APIs and improvements available exclusively in the Kotlin API.")),(0,a.mdx)("h2",{id:"migration-process"},"Migration Process"),(0,a.mdx)("ol",null,(0,a.mdx)("li",{parentName:"ol"},"Preparation:",(0,a.mdx)("ol",{parentName:"li"},(0,a.mdx)("li",{parentName:"ol"},"Ensure you have screenshot tests and/or end-to-end tests in place to verify functionality post-migration."),(0,a.mdx)("li",{parentName:"ol"},"Consider breaking down large or complex specs into smaller components."))),(0,a.mdx)("li",{parentName:"ol"},"Conversion:",(0,a.mdx)("ol",{parentName:"li"},(0,a.mdx)("li",{parentName:"ol"},"Convert your Java layout spec to Kotlin using the j2k tool."),(0,a.mdx)("li",{parentName:"ol"},"Run the conversion script for the Layout spec:")))),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre"},".fbandroid/scripts/litho/convert_spec_to_kotlin_api.sh <spec.kt>\n")),(0,a.mdx)("p",null,"If automatic conversion fails, use the ",(0,a.mdx)("inlineCode",{parentName:"p"},"--save")," option to save changes and manually fix errors:"),(0,a.mdx)("pre",null,(0,a.mdx)("code",{parentName:"pre"},".fbandroid/scripts/litho/convert_spec_to_kotlin_api.sh <spec.kt> --save\n")),(0,a.mdx)("ol",{start:3},(0,a.mdx)("li",{parentName:"ol"},"Testing:",(0,a.mdx)("ol",{parentName:"li"},(0,a.mdx)("li",{parentName:"ol"},"Run buck build for the migrated module to ensure it can be built successfully."),(0,a.mdx)("li",{parentName:"ol"},"Run screenshot or end-to-end tests to ensure they still pass.")))),(0,a.mdx)("h2",{id:"current-limitations"},"Current Limitations"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},"The current codemod cannot handle all APIs due to the complexity of the Layout spec. ",(0,a.mdx)("a",{parentName:"li",href:"https://www.internalfb.com/code/fbsource/xplat/scripts/codemod_service/litho/spec_to_kotlin_api_conversion_input.sh?lines=5"},"Unhandled APIs "),"are filtered out, and manual migration will be needed to handle all these cases."),(0,a.mdx)("li",{parentName:"ul"},"There is no codemod available for MountSpec and Sections as the small number of usages. Refer to the ",(0,a.mdx)("a",{parentName:"li",href:"https://fblitho.com/docs/kotlin/migrating-from-mountspecs-to-primitives/"},"Migrating MountSpecs to PrimitiveComponents")," and ",(0,a.mdx)("a",{parentName:"li",href:"https://fblitho.com/docs/kotlin/lazycollections/lazycollections-sections-migration/"},"Migrating Sections to LazyCollections")," for detailed steps.")),(0,a.mdx)("h2",{id:"additional-resources"},"Additional Resources"),(0,a.mdx)("ul",null,(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("a",{parentName:"li",href:"https://fblitho.com/docs/kotlin/kotlin-api-basics/"},"Kotlin API")),(0,a.mdx)("li",{parentName:"ul"},(0,a.mdx)("a",{parentName:"li",href:"https://fblitho.com/docs/kotlin/kotlin-api-cheatsheet/"},"Cheatsheet"))))}f.isMDXComponent=!0},68382:(e,t,n)=>{n.d(t,{Ay:()=>f,Gs:()=>i});var r=n(61258);const o={plain:{backgroundColor:"#2a2734",color:"#9a86fd"},styles:[{types:["comment","prolog","doctype","cdata","punctuation"],style:{color:"#6c6783"}},{types:["namespace"],style:{opacity:.7}},{types:["tag","operator","number"],style:{color:"#e09142"}},{types:["property","function"],style:{color:"#9a86fd"}},{types:["tag-id","selector","atrule-id"],style:{color:"#eeebff"}},{types:["attr-name"],style:{color:"#c4b9fe"}},{types:["boolean","string","entity","url","attr-value","keyword","control","directive","unit","statement","regex","atrule","placeholder","variable"],style:{color:"#ffcc99"}},{types:["deleted"],style:{textDecorationLine:"line-through"}},{types:["inserted"],style:{textDecorationLine:"underline"}},{types:["italic"],style:{fontStyle:"italic"}},{types:["important","bold"],style:{fontWeight:"bold"}},{types:["important"],style:{color:"#c4b9fe"}}]};var a=n(96540),i={Prism:r.A,theme:o};function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}var c=/\r\n|\r|\n/,u=function(e){0===e.length?e.push({types:["plain"],content:"\n",empty:!0}):1===e.length&&""===e[0].content&&(e[0].content="\n",e[0].empty=!0)},p=function(e,t){var n=e.length;return n>0&&e[n-1]===t?e:e.concat(t)};function d(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===t.indexOf(r)&&(n[r]=e[r]);return n}var m=function(e){function t(){for(var t=this,n=[],r=arguments.length;r--;)n[r]=arguments[r];e.apply(this,n),l(this,"getThemeDict",(function(e){if(void 0!==t.themeDict&&e.theme===t.prevTheme&&e.language===t.prevLanguage)return t.themeDict;t.prevTheme=e.theme,t.prevLanguage=e.language;var n=e.theme?function(e,t){var n=e.plain,r=Object.create(null),o=e.styles.reduce((function(e,n){var r=n.languages,o=n.style;return r&&!r.includes(t)||n.types.forEach((function(t){var n=s({},e[t],o);e[t]=n})),e}),r);return o.root=n,o.plain=s({},n,{backgroundColor:null}),o}(e.theme,e.language):void 0;return t.themeDict=n})),l(this,"getLineProps",(function(e){var n=e.key,r=e.className,o=e.style,a=s({},d(e,["key","className","style","line"]),{className:"token-line",style:void 0,key:void 0}),i=t.getThemeDict(t.props);return void 0!==i&&(a.style=i.plain),void 0!==o&&(a.style=void 0!==a.style?s({},a.style,o):o),void 0!==n&&(a.key=n),r&&(a.className+=" "+r),a})),l(this,"getStyleForToken",(function(e){var n=e.types,r=e.empty,o=n.length,a=t.getThemeDict(t.props);if(void 0!==a){if(1===o&&"plain"===n[0])return r?{display:"inline-block"}:void 0;if(1===o&&!r)return a[n[0]];var i=r?{display:"inline-block"}:{},l=n.map((function(e){return a[e]}));return Object.assign.apply(Object,[i].concat(l))}})),l(this,"getTokenProps",(function(e){var n=e.key,r=e.className,o=e.style,a=e.token,i=s({},d(e,["key","className","style","token"]),{className:"token "+a.types.join(" "),children:a.content,style:t.getStyleForToken(a),key:void 0});return void 0!==o&&(i.style=void 0!==i.style?s({},i.style,o):o),void 0!==n&&(i.key=n),r&&(i.className+=" "+r),i})),l(this,"tokenize",(function(e,t,n,r){var o={code:t,grammar:n,language:r,tokens:[]};e.hooks.run("before-tokenize",o);var a=o.tokens=e.tokenize(o.code,o.grammar,o.language);return e.hooks.run("after-tokenize",o),a}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.render=function(){var e=this.props,t=e.Prism,n=e.language,r=e.code,o=e.children,a=this.getThemeDict(this.props),i=t.languages[n];return o({tokens:function(e){for(var t=[[]],n=[e],r=[0],o=[e.length],a=0,i=0,l=[],s=[l];i>-1;){for(;(a=r[i]++)<o[i];){var d=void 0,m=t[i],f=n[i][a];if("string"==typeof f?(m=i>0?m:["plain"],d=f):(m=p(m,f.type),f.alias&&(m=p(m,f.alias)),d=f.content),"string"==typeof d){var y=d.split(c),v=y.length;l.push({types:m,content:y[0]});for(var g=1;g<v;g++)u(l),s.push(l=[]),l.push({types:m,content:y[g]})}else i++,t.push(m),n.push(d),r.push(0),o.push(d.length)}i--,t.pop(),n.pop(),r.pop(),o.pop()}return u(l),s}(void 0!==i?this.tokenize(t,r,i,n):[r]),className:"prism-code language-"+n,style:void 0!==a?a.root:{},getLineProps:this.getLineProps,getTokenProps:this.getTokenProps})},t}(a.Component);const f=m},76062:(e,t,n)=>{n.d(t,{A:()=>r});const r={plain:{color:"#F8F8F2",backgroundColor:"#282A36"},styles:[{types:["prolog","constant","builtin"],style:{color:"rgb(189, 147, 249)"}},{types:["inserted","function"],style:{color:"rgb(80, 250, 123)"}},{types:["deleted"],style:{color:"rgb(255, 85, 85)"}},{types:["changed"],style:{color:"rgb(255, 184, 108)"}},{types:["punctuation","symbol"],style:{color:"rgb(248, 248, 242)"}},{types:["string","char","tag","selector"],style:{color:"rgb(255, 121, 198)"}},{types:["keyword","variable"],style:{color:"rgb(189, 147, 249)",fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(98, 114, 164)"}},{types:["attr-name"],style:{color:"rgb(241, 250, 140)"}}]}},45603:(e,t,n)=>{n.d(t,{A:()=>r});const r={plain:{color:"#393A34",backgroundColor:"#f6f8fa"},styles:[{types:["comment","prolog","doctype","cdata"],style:{color:"#999988",fontStyle:"italic"}},{types:["namespace"],style:{opacity:.7}},{types:["string","attr-value"],style:{color:"#e3116c"}},{types:["punctuation","operator"],style:{color:"#393A34"}},{types:["entity","url","symbol","number","boolean","variable","constant","property","regex","inserted"],style:{color:"#36acaa"}},{types:["atrule","keyword","attr-name","selector"],style:{color:"#00a4db"}},{types:["function","deleted","tag"],style:{color:"#d73a49"}},{types:["function-variable"],style:{color:"#6f42c1"}},{types:["tag","selector","keyword"],style:{color:"#00009f"}}]}}}]);