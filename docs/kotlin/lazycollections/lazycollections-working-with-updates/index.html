<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-44373548-28","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Litho" href="/opensearch.xml"><title data-react-helmet="true">Working with Updates | Litho</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://fblitho.com/docs/kotlin/lazycollections/lazycollections-working-with-updates/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Working with Updates | Litho"><meta data-react-helmet="true" name="description" content="A lazy collection is updated by changing the changing the prop/state values from which it is generated. To ensure correctness and performance you must:"><meta data-react-helmet="true" property="og:description" content="A lazy collection is updated by changing the changing the prop/state values from which it is generated. To ensure correctness and performance you must:"><link data-react-helmet="true" rel="shortcut icon" href="/images/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://fblitho.com/docs/kotlin/lazycollections/lazycollections-working-with-updates/"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/kotlin/lazycollections/lazycollections-working-with-updates/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://fblitho.com/docs/kotlin/lazycollections/lazycollections-working-with-updates/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.500f1454.css">
<link rel="preload" href="/assets/js/runtime~main.8e434651.js" as="script">
<link rel="preload" href="/assets/js/main.c921d0e3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="color:#091E42" role="banner"><div class="announcementBarContent_3EUC">Support Ukraine üá∫üá¶ <a target="_blank" rel="noopener noreferrer" href="https://opensource.facebook.com/support-ukraine">Help Provide Humanitarian Aid to Ukraine</a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/images/logo.svg" alt="Litho Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Litho</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro/motivation/">Docs</a><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a><a class="navbar__item navbar__link" href="/docs/tutorial/overview/">Tutorial</a><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_1lV3"><div class="docItemContainer_zt2Y"><article><header><h1 class="docTitle_1y8q">Working with Updates</h1></header><div class="markdown"><p>A lazy collection is updated by changing the changing the prop/state values from which it is generated. To ensure correctness and performance you must:</p><ol><li><a href="#child-identity">Provide ids</a> for any children that can be updated.</li><li>Make sure props of children don&#x27;t unnecessarily change, leading to <a href="#avoiding-unecessary-layouts">unnecessary layouts</a>.</li></ol><h2 class="anchor anchorWithStickyNavbar_31ik" id="child-identity">Child Identity<a aria-hidden="true" class="hash-link" href="#child-identity" title="Direct link to heading">‚Äã</a></h2><p>When the data backing a lazy collection is updated, children may have been added, removed, changed position, or had their content updated. The lazy collection will determine what has changed and apply the minimal changeset. This is done by comparing items from the old and new lists using the <code>id</code> parameter specified on the children.</p><p>By default, an &#x27;id&#x27; is generated for each child based on its position and type. This is only sufficient for simple static lists. If the list is expected to be updated, you should provide an id that is consistent across renders.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">child(id = friend.id, component = Text(friend.name))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>An <code>id</code> must be unique and immutable.</strong> Breaking this contract may lead to occasional <code>IndexOutOfBoundsException</code> exceptions during layout.</p><p><strong>You should always provide an <code>id</code> when adding items in a loop.</strong> Using the loop index is unacceptable as items may change positions. Instead, use an id from the data model.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="avoiding-unnecessary-layouts">Avoiding Unnecessary Layouts<a aria-hidden="true" class="hash-link" href="#avoiding-unnecessary-layouts" title="Direct link to heading">‚Äã</a></h2><p>During a list update, if a child with the same <code>id</code> is found in the old and new lists then the lazy collection automatically detects if the content has changed. If an update has not occurred, the subtree will be re-used as-is, otherwise it is re-created.</p><p>Content changes are detected by checking the equality of the component&#x27;s props. <strong>If any component prop does not implement an <code>equals()</code> then it cannot be reused</strong>. It is common for classes to not implement <code>equals()</code> such as Drawables, Lambdas, and data models. A little bit more work is required to avoid unnecessary layouts when these are used.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p><strong>The behaviour will be functionally correct by default.</strong> If you use props that do not provide an <code>equals()</code> the UI will still use the most up-to-date prop and state values. However, there will be unnecessary layouts which will impact performance.</p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="using-classes-without-equals-as-props">Using Classes Without <code>equals()</code> as Props<a aria-hidden="true" class="hash-link" href="#using-classes-without-equals-as-props" title="Direct link to heading">‚Äã</a></h3><p>If a component accepts a prop that does not implement an <code>equals()</code> then it will never be reused.</p><p>Consider the following example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Name(val firstName: String, val secondName: String)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class NameComponent(val name: Name) : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = Text(&quot;${name.firstName} ${name.secondName}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class NameList_UnnecessaryUpdate : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(NameComponent(Name(&quot;Mark&quot;, &quot;Zuckerberg&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the above example, <code>NameComponent</code> will be laid out on any update because it takes a prop of type <code>Name</code> that does not implement an <code>equals()</code>.</p><p>Unnecessary layouts can be avoided using two methods:</p><ol><li>Add an <code>equals()</code> to the <code>Name</code> class, such as by making it a <code>data</code> class. This approach will not be possible if you&#x27;re using an object provided by a framework you don&#x27;t control.</li><li>Manually specify the dependencies that, if changed, should trigger an update.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class NameList_Fixed : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Option 1. Convert to a prop with an `equals()` implementation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(NameComponentWithEquals(NameWithEquals(&quot;Mark&quot;, &quot;Zuckerberg&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Option 2. Manually specify dependencies (in this case empty)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(deps = arrayOf()) { NameComponent(Name(&quot;Mark&quot;, &quot;Zuckerberg&quot;)) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>By manually specifying the dependencies, <code>NameComponent</code> is only be laid out once and re-used whenever the Example is updated.</p><p>Consider the following example, which uses an Android <code>Drawable</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Drawable_UnnecessaryUpdate : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(Text(&quot;text&quot;, style = Style.background(ColorDrawable(Color.RED))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the above example, the Text component will be unnecessarily laid out on every update to Example because ColorDrawable does not implement an <code>equals()</code>.</p><p>Here, Unnecessary layouts can be avoided using two techniques:</p><ol><li>Use a drawable that implements equality such as Litho‚Äôs ComparableColorDrawable.</li><li>Manually specify the dependencies that, if changed, will trigger an update.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Drawable_Fixed : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Option 1. Use a `ComparableDrawable` wrapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(Text(&quot;text&quot;, style = Style.background(drawableColor(Color.RED))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Option 2. Manually specify dependencies (in this case empty).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(deps = arrayOf()) { Text(&quot;text&quot;, style = Style.background(ColorDrawable(Color.RED))) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="using-lambdas-as-props">Using Lambdas as Props<a aria-hidden="true" class="hash-link" href="#using-lambdas-as-props" title="Direct link to heading">‚Äã</a></h3><p>Lambdas do not provide an <code>equals()</code>, for example, <code>{} == {}</code> is <code>false</code>. This means that using a lambda as a prop may cause unnecessary layouts.</p><p>Furthermore, lambdas capture values when they are created. For example, in the folling lambda, <code>{ val time = Calendar.getInstance().time }</code>, the value <code>time</code> will contain the time the lambda was created not the time when it was invoked. This means it is not possible to prevent updates using <code>deps</code> as the lambda needs to be regenerated to capture the latest state and prop values.</p><p>To use a lambda in a Lazy Collection, wrap it in a <code>useCallback</code> hook.  This provides equality across layouts, allowing the component to be reused, and the lambda is guaranteed to use the latest prop and state values</p><p>Consider the following example where a lambda is passed to a component:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Lambda_UnnecessaryUpdate(val name: String) : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component = LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child(Text(&quot;text&quot;, style = Style.onClick { println(&quot;Hello $name&quot;) }))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In the above example, the Text will be laid out on any update to Example because the lambda props will never be equal. This can be fixed using the <code>useCallback</code> hook:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class Lambda_Fixed(val name: String) : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val callBack = useCallback { _: ClickEvent -&gt; println(&quot;Hello $name&quot;) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return LazyList { child(Text(&quot;text&quot;, style = Style.onClick(callBack))) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Consider another example, this time displaying a shopping list:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly kotlin"><pre tabindex="0" class="prism-code language-kotlin codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class ShoppingList : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val shoppingList = listOf(&quot;Apples&quot;, &quot;Cheese&quot;, &quot;Bread&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create a state containing the items that should be shown with a checkmark: ‚òë</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Initially empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val checkedItems = useState { setOf&lt;String&gt;() }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Create a callback to toggle the checkmark for an item</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // States should always use immutable data, so a new Set is created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    val toggleChecked = useCallback { item: String -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      checkedItems.update {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        it.toMutableSet().apply { if (contains(item)) remove(item) else add(item) }.toSet()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return LazyList {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      shoppingList.forEach {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        val isChecked = checkedItems.value.contains(it)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        child(id = it, component = ShoppingListItem(it, isChecked, toggleChecked))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class ShoppingListItem(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private val item: String,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private val isChecked: Boolean,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private val toggleSelected: (String) -&gt; Unit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) : KComponent() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  override fun ComponentScope.render(): Component =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Text(&quot;${if (isChecked) &quot;‚òë&quot; else &quot;‚òê&quot;} $item&quot;, style = Style.onClick { toggleSelected(item) })</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Each shopping list item requires a lambda to toggle a checkmark. If an unwrapped lambda was used, then no component would ever be reused as lambda does not provide an <code>equals()</code>. Instead, wrap the lambda in a <code>useCallback</code> hook. This provides equality across renders and ensure that changes are applied to the latest version of the <code>checkedItems</code> state.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/litho/edit/master/website/../docs/kotlin/lazycollections/lazycollections-working-with-updates.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#child-identity" class="table-of-contents__link toc-highlight">Child Identity</a></li><li><a href="#avoiding-unnecessary-layouts" class="table-of-contents__link toc-highlight">Avoiding Unnecessary Layouts</a><ul><li><a href="#using-classes-without-equals-as-props" class="table-of-contents__link toc-highlight">Using Classes Without <code>equals()</code> as Props</a></li><li><a href="#using-lambdas-as-props" class="table-of-contents__link toc-highlight">Using Lambdas as Props</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started</a></li><li class="footer__item"><a href="/javadoc" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Open Source</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/contributing/">How To Contribute</a></li><li class="footer__item"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Open Source Projects<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/litho" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/fblitho" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_MyFc"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/images/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright ¬© 2022 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8e434651.js"></script>
<script src="/assets/js/main.c921d0e3.js"></script>
</body>
</html>