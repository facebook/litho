(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{110:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return c})),t.d(n,"rightToc",(function(){return u})),t.d(n,"default",(function(){return s}));var r=t(2),o=t(6),i=(t(0),t(161)),a=(t(179),{id:"reconciliation",title:"Introduction"}),c={unversionedId:"deep-dive/reconciliation",id:"deep-dive/reconciliation",isDocsHomePage:!1,title:"Introduction",description:"Reconciliation is an implementation detail in Litho\u2019s layout calculation process. Instead of",source:"@site/../docs/deep-dive/reconciliation.mdx",slug:"/deep-dive/reconciliation",permalink:"/docs/deep-dive/reconciliation",editUrl:"https://github.com/facebook/litho/edit/master/website/../docs/deep-dive/reconciliation.mdx",version:"current",sidebar:"mainSidebar",previous:{title:"Coding Style",permalink:"/docs/best-practices/coding-style"},next:{title:"Enabling Reconciliation",permalink:"/docs/deep-dive/reconciliation/enabling-reconciliation"}},u=[{value:"Tradeoffs",id:"tradeoffs",children:[]}],l={rightToc:u};function s(e){var n=e.components,t=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Reconciliation is an implementation detail in Litho\u2019s layout calculation process. Instead of\nrecreating the entire layout tree for every update reconciliation enables Litho to clone the\nunmodified subtrees and only recreate the subtree which has changed."),Object(i.b)("p",null,"When using Litho, the component hierarchy is determined by what is returned by the\n",Object(i.b)("inlineCode",{parentName:"p"},"OnCreateLayout")," method. On the next state or prop update, the ",Object(i.b)("inlineCode",{parentName:"p"},"OnCreateLayout")," may return a different\ntree of components. Litho uses reconciliation to figure out which components should be re-created\nand which can be re-used (read cloned)."),Object(i.b)("p",null,"In essence, this means Litho will not call (most) lifecycle methods of components which were\nunaffected by the update. Reconciliation doubles down on the requirement that component specs must\nbe immutable and should not rely on side effects to achieve any desired behaviour."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(r.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(r.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(r.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(r.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"note")),Object(i.b)("div",Object(r.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"As of December 2020 reconciliation is only implemented for state updates."))),Object(i.b)("h2",{id:"tradeoffs"},"Tradeoffs"),Object(i.b)("p",null,"It is important to remember that the reconciliation algorithm is an implementation detail. Litho\ncould re-create the whole hierarchy on every action; the end result would be the same. Just to be\nclear, re-creation in this context means calling ",Object(i.b)("inlineCode",{parentName:"p"},"OnCreateLayout")," for the modified component, it\ndoesn\u2019t mean Litho will unmount and remount them. Litho will only mount and unmount items will\nwhich have changed."),Object(i.b)("p",null,"In order to reconcile changes, Litho keeps the previous component hierarchy in memory. This\nincreases memory usage and can potentially increase OOMs."))}s.isMDXComponent=!0},161:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return h}));var r=t(0),o=t.n(r);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=o.a.createContext({}),s=function(e){var n=o.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},d=function(e){var n=s(e.components);return o.a.createElement(l.Provider,{value:n},e.children)},f={inlineCode:"code",wrapper:function(e){var n=e.children;return o.a.createElement(o.a.Fragment,{},n)}},p=o.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,a=e.parentName,l=u(e,["components","mdxType","originalType","parentName"]),d=s(t),p=r,h=d["".concat(a,".").concat(p)]||d[p]||f[p]||i;return t?o.a.createElement(h,c(c({ref:n},l),{},{components:t})):o.a.createElement(h,c({ref:n},l))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,a=new Array(i);a[0]=p;var c={};for(var u in n)hasOwnProperty.call(n,u)&&(c[u]=n[u]);c.originalType=e,c.mdxType="string"==typeof e?e:r,a[1]=c;for(var l=2;l<i;l++)a[l]=t[l];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},162:function(e,n,t){"use strict";var r=t(0),o=t(20);n.a=function(){var e=Object(r.useContext)(o.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},173:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return o})),t.d(n,"useAllPluginInstancesData",(function(){return i})),t.d(n,"usePluginData",(function(){return a}));var r=t(162);function o(){var e=Object(r.a)().globalData;if(!e)throw new Error("Docusaurus global data not found");return e}function i(e){var n=o()[e];if(!n)throw new Error("Docusaurus plugin global data not found for pluginName="+e);return n}function a(e,n){void 0===n&&(n="default");var t=i(e)[n];if(!t)throw new Error("Docusaurus plugin global data not found for pluginName="+e+" and pluginId="+n);return t}},174:function(e,n){var t,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],s=!1,d=-1;function f(){s&&u&&(s=!1,u.length?l=u.concat(l):d=-1,l.length&&p())}function p(){if(!s){var e=c(f);s=!0;for(var n=l.length;n;){for(u=l,l=[];++d<n;)u&&u[d].run();d=-1,n=l.length}u=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(e)}}function h(e,n){this.fun=e,this.array=n}function m(){}o.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];l.push(new h(e,n)),1!==l.length||s||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},179:function(e,n,t){(function(n){const r=["internal","external"];let o;try{o=t(173).usePluginData}catch(u){o=null}function i(e){return function(e){if("object"!=typeof e)throw new Error(`fbContent() args must be an object containing keys: ${r}. Instead got ${e}`);if(!Object.keys(e).find(e=>r.find(n=>n===e)))throw new Error(`No valid args found in ${JSON.stringify(e)}. Accepted keys: ${r}`);const n=Object.keys(e).filter(e=>!r.find(n=>n===e));if(n.length>0)throw new Error(`Unexpected keys ${n} found in fbContent() args. Accepted keys: ${r}`)}(e),c()?"internal"in e?a(e.internal):[]:"external"in e?a(e.external):[]}function a(e){return"function"==typeof e?e():e}function c(){return n.env.FB_INTERNAL||o&&o("internaldocs-fb").FB_INTERNAL}e.exports={fbContent:i,fbInternalOnly:function(e){return i({internal:e})},isInternal:c,FbInternalOnly:function(e){return c()?e.children:null},OssOnly:function(e){return c()?null:e.children}}}).call(this,t(174))}}]);